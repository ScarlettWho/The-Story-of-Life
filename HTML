<!doctype html>
<html lang='en'>
<head>
<title>The Story of Life</title>
<meta charset='utf-8'>
<style>
body {
	background-image: url("http://www.happylittlechatters.com.au/images/background.jpg");
	background-size: 100%;
	background-repeat: no-repeat;;
}
canvas {
	border: 3px solid black;;
	padding: 0;
	margin: auto;
	display: block;
	width: 600px;
	height: 400px;
	position: absolute;
	top: 0;
	bottom: 0;
	left: 0;
	right: 0;
}
</style>
<body>
	<canvas id = 'canvas' width = '600' height = '400'></canvas>
	
	
	<input type = 'button' id = 'attack' value = 'Defend' onclick = 'stndGround()' disabled = 'true'>
	<br>
	<input type = 'button' id = 'listen' value = 'Listen' onclick = 'bearAttack()' disabled = 'true'>
	<br>
	<input type = 'button' id = 'revisit' value = 'Return' onclick = 'enterLove()' disabled = 'true'>
	<br>
	<input type = 'button' id = 'meet' value = 'Meet' onclick = 'greetPerson()' disabled = 'true'>
	<br>
	<input type = 'button' id = 'share' value = 'Share' onclick = 'sharing()' disabled = 'true'>
	<br>
	<input type = 'button' id = 'escape' value = 'RUN!' onclick = '()' disabled = 'true'>

</body>

<script>
var canvas = document.getElementById('canvas');
var context = canvas.getContext('2d');
var timer;
var found = false;


//draws scene
function fillBG() {
	context.fillStyle = '#81DAF5';
	context.fillRect(0, 0, canvas.width, canvas.height);
	context.fillStyle = '#04B404';
	context.fillRect(0, 370, canvas.width, 30);
	context.beginPath();
	context.moveTo(0,372);
	context.lineTo(canvas.width,372);
	context.strokeStyle = '#0A2A12';
	context.stroke();
	function Sun() {
		context.beginPath();
		context.arc(560, 40, 30, degreesToRadians(360), false);
		context.fillStyle = '#FACC2E';
		context.fill();

		context.beginPath();
		context.arc(560, 40, 35, degreesToRadians(360), false);
		context.strokeStyle = '#FFFF00';
		context.lineWidth = 2;
		context.stroke();

		context.beginPath();
		context.arc(556, 38, 37, degreesToRadians(360), false);
		context.strokeStyle = '#F7FE2E';
		context.lineWidth = 1;
		context.stroke();

		context.beginPath();
		context.arc(563, 43, 40, degreesToRadians(360), false);
		context.strokeStyle = '#FACC2E';
		context.lineWidth = 1;
		context.stroke();

		context.beginPath();
		context.arc(555, 44, 39, degreesToRadians(360), false);
		context.strokeStyle = '#F2F5A9';
		context.lineWidth = 2;
		context.stroke();
	}
	function clouds() {
		context.beginPath();
		context.moveTo(30,50);
		context.bezierCurveTo(30,5,70,50,60,30);
		context.bezierCurveTo(50,20,110,5,80,50);
		context.bezierCurveTo(60,15,200,15,100,80);
		context.bezierCurveTo(100,150,50,80,60,90);
		context.bezierCurveTo(50,160,5,100,30,49);
		context.lineWidth = 7;
		context.strokeStyle = '#A9F5F2';
		context.stroke();

		context.beginPath();
		context.moveTo(150,170);
		context.bezierCurveTo(150,110,190,170,180,150);
		context.bezierCurveTo(130,120,190,20,210,160);
		context.bezierCurveTo(300,130,180,235,200,170);
		context.bezierCurveTo(300,150,160,270,180,190);
		context.bezierCurveTo(200,200,150,280,150,169);
		context.lineWidth = 3;
		context.strokeStyle = '#A9F5F2';
		context.stroke();
	}
	function flower() {
		//stem
		context.beginPath();
		context.moveTo(400,372);
		context.lineTo(400,305);
		context.lineWidth = 3
		context.strokeStyle = '#0A2A12';
		context.stroke();
		//petals
		context.beginPath();
		context.moveTo(400,300);
		context.bezierCurveTo(395,320,405,320,400,300);
		context.bezierCurveTo(410.606,317.678,417.678,310.606,400,300);
		context.bezierCurveTo(420,305,420,295,400,300);
		context.bezierCurveTo(417.678,289.394,410.606,282.322,400,300);
		context.bezierCurveTo(405,280,395,280,400,300);
		context.bezierCurveTo(389.394,282.322,382.322,289.394,400,300);
		context.bezierCurveTo(380,295,380,305,400,300);
		context.bezierCurveTo(382.322,310.606,389.394,317.678,400,300);
		context.closePath()
		context.fillStyle = "pink"
		context.fill();
		//center
		context.beginPath();
		context.arc(400, 300, 4, degreesToRadians(360), false);
		context.fillStyle = '#FACC2E';
		context.fill();
	}

	flower();
	Sun();
	clouds();
}


//text functions
function startText() {
	strtTxt = "Click the correct spot to be born into the LIGHT.";
	m = 130;
	i = 0;

	//for (i = 0; i < strtTxt.length; i++) {
	delay = setTimeout(function(){
	type = setInterval(function(){
		lttrSize = Number(context.measureText(strtTxt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(strtTxt.charAt(i), m, 200);
		i++;
		m += lttrSize+1;
		if (i == strtTxt.length) {
			clearInterval(type);
			}
	//}
		},100);
	},1500);
}

function prettyText() {
	prttyTxt = "Look! Something beautiful. Go take a look.";
	m = 130;
	i = 0;

	delay = setTimeout(function(){
		type = setInterval(function(){
		lttrSize = Number(context.measureText(prttyTxt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(prttyTxt.charAt(i), m, 200);
		i++;
		m += lttrSize + 1;
		if (i == prttyTxt.length) {
			clearInterval(type);
			fillBG();
			drawPerson();
			instrct1();
			}
		},100);
	},1000);
}

function instrct1() {
	//console.log("wat");

	instrct1Txt = "Use the arrow keys to move left and right."
	m = 130;
	i = 0;
	delay = setTimeout(function(){
		type = setInterval(function(){
		lttrSize = Number(context.measureText(instrct1Txt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(instrct1Txt.charAt(i), m, 200);
		i++;
		m += lttrSize + 1;
		if (i == instrct1Txt.length) {
			clearInterval(type);
			fillBG();
			drawPerson();
			}
		},100);
	},500);
}

function ohNoText() {
	m = 200;
	n = 150;
	o = 400;
	p = 280;

	delay = setTimeout(function(){
		shift = setInterval(function(){
			fillBG();
			drawPerson();
			context.font = "20px Matisse itc";
			context.fillStyle = "black";
			context.fillText("~growl~", m, n);
			m +=1;
			n +=1;
			if (m == 210){
				clearInterval(shift);
				fillBG();
				drawPerson();
				shift = setInterval(function(){
					fillBG();
					drawPerson();
					context.font = "20px Matisse itc";
					context.fillStyle = "black";
					context.fillText("~growl~", o, p);
					o -=1;
					p -=1;
					if (o == 380) {
						clearInterval(shift)
						fillBG();
						drawPerson();
					}
				},50);
			}
		},50);
	},1500);
	
	watDatTxt = "What's that sound?"
	m = 130;
	i =0;
	delay = setTimeout(function(){
		type = setInterval(function(){
		lttrSize = Number(context.measureText(watDatTxt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(watDatTxt.charAt(i), m, 200);
		i++;
		m += lttrSize + 1;
		if (i == watDatTxt.length) {
			clearInterval(type);
			instrct2();
			}
		},100);
	},8000);
}
function instrct2() {
	instrct1Txt = "Press L to listen closer."
	m = 130;
	i = 0;
	delay = setTimeout(function(){
		type = setInterval(function(){
		lttrSize = Number(context.measureText(instrct1Txt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(instrct1Txt.charAt(i), m, 250);
		i++;
		m += lttrSize + 1;
		if (i == instrct1Txt.length) {
			clearInterval(type);
			}
		},100);
	},500);
}
function Ahhh() {
	starsTxt = "My stars! It's a bear!"
	m = 130;
	i = 0;
	delay = setTimeout(function(){
		type = setInterval(function(){
		lttrSize = Number(context.measureText(starsTxt.charAt(i)).width);
		context.font = "20px Matisse itc";
		context.fillStyle = "black";
		context.fillText(starsTxt.charAt(i), m, 250);
		i++;
		m += lttrSize + 1;
		if (i == starsTxt.length) {
			clearInterval(type);
			}
		},100);
	},4000);
	
	delay = setTimeout(function(){
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("Defend the beauty in your world!", 150, 150);
	},6000);
}
function loveText() {
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("Good job!", 200, 250);

	delay = setTimeout(function(){
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("Return to the beautiful thing.", 150, 150);
	},600);
}
function whoDatText() {
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("Who's that? Go meet them.", 200, 250);	
}
function shareText() {
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("Why not share the thing you fought so hard for.", 200, 250);
}
function ironyText() {
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("What's this?! A hilarious case of irony!  Run!", 200, 250);
}
function deathText() {
	context.font = "20px Matisse itc";
	context.fillStyle = "black";
	context.fillText("WAlas, you've suffered the consequences of your choices and convictions. Now you're dead.", 200, 250);
}


//user functions
function clickSun(x, y) {
	//console.log('Nope');
	if (found == true) {
			console.log(found);
			return;
		}
	d = Math.sqrt((560 - x)*(560 - x) + (40 - y)*(40 - y));
	if (d <= 176) {
		born();
		found = true;
		//console.log('Yep');
		//console.log(d);
		}	
}

document.addEventListener('keydown', playerMove, false);
document.addEventListener('keydown', playerListen, false);
function playerMove(e) {
	if (e.keyCode == 39 && bottom.x < 330) {
		console.log("move");
	fillBG();
	drawPerson();
	bottom.x += 12;
	shirt.x += 12;
	head.x += 12;
	arm.x += 12;
	sleeve.x += 12;
	hair.x += 12;
	}
	else if (e.keyCode == 37 && bottom.x < 330 && bottom.x > 5) {
		console.log("pls");
	fillBG();
	drawPerson();
	bottom.x -= 12;
	shirt.x -= 12;
	head.x -= 12;
	arm.x -= 12;
	sleeve.x -= 12;
	hair.x -= 12;
	}
	else if (bottom.x >= 330) {
		document.removeEventListener('keydown', playerMove,false);
		ohNoText();
	}
}
function playerListen(e) {
	if (e.keyCode == 76) {
		bearAttack();
	}
}






//story functions
function born() {
	delay = setTimeout(function(){
	fillBG();
	drawPerson();
	//drawLove();
	prettyText();
	},600);	
}
function bearAttack() {
	timer = setInterval(function(){
		body.x -= 3;
		back.x -= 3;
		neck.x -= 3;
		neck2.x -= 3;
		legA.x -= 3;
		legB.x -= 3;
		ear.x -= 3;
		tail.x -= 3;
		
		fillBG();
		drawBear();
		drawPerson();
		if(neck2.x < 440)
			clearInterval(timer);
			//Ahhh();
	},50);

		document.getElementById('listen').disabled = true;
		document.getElementById('attack').disabled = false;
		Ahhh();
}
function stndGround() {
	timer = setInterval(function(){
	bottom.x += 12;
	shirt.x += 12;
	head.x += 12;
	arm.x += 12;
	sleeve.x += 12;
	hair.x += 12;

	body.x += 12;
	back.x += 12;
	neck.x += 12;
	neck2.x += 12;
	legA.x += 12;
	legB.x += 12;
	ear.x += 12;
	tail.x += 12;

	fillBG();
	drawBear();
	drawPerson();
	if(neck2.x > 600)
		clearInterval(timer);
		loveText();
	},50);
	document.getElementById('attack').disabled = true;
	document.getElementById('revisit').disabled = false;	
}
function greetPerson() {
	fillBG();
	drawPerson();
	drawLove();

	bottom.x -= 12;
	shirt.x -= 12;
	head.x -= 12;
	arm.x -= 12;
	sleeve.x -= 12;
	hair.x -= 12;
	
	if (bottom.x <= 423) {
		document.getElementById('meet').disabled = true;
		document.getElementById('share').disabled = false;
		shareText();
	}
}
function enterLove() {
	drawLove();
	timer = setInterval(function(){
	
	loveBottom.x += 12;
	loveShirt.x += 12;
	loveHead.x += 12;
	loveArm.x += 12;
	loveSleeve.x += 12;
	loveHair.x += 12;

	fillBG();
	drawLove();
	drawPerson();

	if(loveBottom.x > 330)
		clearInterval(timer);
		whoDatText();	
	},100);

	document.getElementById('revisit').disabled = true;
	document.getElementById('meet').disabled = false;
}
function sharing() {
	delay = setTimeout(function(){
		ironyText()},3000);
	fillBG();
	drawPerson();
	drawLove();
	//bee();
	drawBee();
}
function beeAttack() {

}
function dead() {

}



//person variables
var bottom = {x:5, y:320, width:30, height:50};
var shirt = {x:5, y:320, width:30, height:46};
var head = {x:5, y:320, width:30, height:20};
var arm = {x:15, y:340, width:12, height:25};
var sleeve = {x:15, y:340, width:12, height:10};
var hair = {x:5, y:320, width:30, height:4};
function drawPerson() {
	//bottom
	context.beginPath();
	context.rect(bottom.x, bottom.y, bottom.width, bottom.height);
	context.fillStyle = "black";
	context.fill();

	//shirt
	context.beginPath();
	context.rect(shirt.x, shirt.y, shirt.width, shirt.height);
	context.fillStyle = "red";
	context.fill();

	//head
	context.beginPath();
	context.rect(head.x, head.y, head.width, head.height);
	context.fillStyle = "#B45F04";
	context.fill();
	//arm
	context.beginPath();
	context.rect(arm.x, arm.y, arm.width, arm.height);
	context.fillStyle = "#B45F04";
	context.fill();

	//sleeve
	context.beginPath();
	context.rect(sleeve.x, sleeve.y, sleeve.width, sleeve.height);
	context.fillStyle = "#B40404";
	context.fill();

	//hair
	context.beginPath();
	context.rect(hair.x, hair.y, hair.width, hair.height);
	context.fillStyle = "black";
	context.fill();
}
//love variables
var loveBottom = {x:-30, y:320, width:30, height:50};
var loveShirt = {x:-30, y:320, width:30, height:46};
var loveHead = {x:-30, y:320, width:30, height:20};
var loveArm = {x:-24, y:340, width:12, height:25};
var loveSleeve = {x:-24, y:340, width:12, height:10};
var loveHair = {x:-30, y:320, width:30, height:4};
function drawLove() {
	//bottom
	context.beginPath();
	context.rect(loveBottom.x, loveBottom.y, loveBottom.width, loveBottom.height);
	context.fillStyle = "black";
	context.fill();

	//shirt
	context.beginPath();
	context.rect(loveShirt.x, loveShirt.y, loveShirt.width, loveShirt.height);
	context.fillStyle = "#8181F7";
	context.fill();

	//head
	context.beginPath();
	context.rect(loveHead.x, loveHead.y, loveHead.width, loveHead.height);
	context.fillStyle = "#F6D8CE";
	context.fill();
	//arm
	context.beginPath();
	context.rect(loveArm.x, loveArm.y, loveArm.width, loveArm.height);
	context.fillStyle = "#F6D8CE";
	context.fill();

	//sleeve
	context.beginPath();
	context.rect(loveSleeve.x, loveSleeve.y, loveSleeve.width, loveSleeve.height);
	context.fillStyle = "#5858FA";
	context.fill();

	//hair
	context.beginPath();
	context.rect(loveHair.x, loveHair.y, loveHair.width, loveHair.height);
	context.fillStyle = "#3B0B0B";
	context.fill();
}
//bear variables
var body = {x:647, y:290, width:80, height:55};
var back = {x:652, y:280, width:70, height:55};
var neck = {x:627, y:285, width:30, height:53};
var neck2 = {x:617, y:290, width:30, height:50};
//var bear = {x:600, y:305, width:50, height:30};
var legA = {x:637, y:320, width:30, height:50};
var legB = {x:707, y:320, width:30, height:50};
var ear = {x:622, y:280, width:12, height:12};
var tail = {x:724, y:295, width:12, height:12};
function drawBear() {
	//body
	context.beginPath();
	context.rect(body.x, body.y, body.width, body.height);
	context.fillStyle = "#8A4B08";
	context.fill();
	//back
	context.beginPath();
	context.rect(back.x, back.y, back.width, back.height);
	context.fillStyle = "#8A4B08";
	context.fill();
	//neck
	context.beginPath();
	context.rect(neck.x, neck.y, neck.width, neck.height);
	context.fillStyle = "#8A4B08";
	context.fill();
	//neck2
	context.beginPath();
	context.rect(neck2.x, neck2.y, neck2.width, neck2.height);
	context.fillStyle = "#8A4B08";
	context.fill();
	//head
	/*context.beginPath();
	context.rect(bear.x, bear.y, bear.width, bear.height);
	context.fillStyle = "#8A4B08";
	context.fill();*/
	//legA
	context.beginPath();
	context.rect(legA.x, legA.y, legA.width, legA.height);
	context.fillStyle = "#61380B";
	context.fill();
	//legA1
	context.beginPath();
	context.rect(legB.x, legB.y, legB.width, legB.height);
	context.fillStyle = "#61380B";
	context.fill();
	//legB
	context.beginPath();
	context.rect(ear.x, ear.y, ear.width, ear.height);
	context.fillStyle = "#61380B";
	context.fill();
	//legB1
	context.beginPath();
	context.rect(tail.x, tail.y, tail.width, tail.height);
	context.fillStyle = "#8A4B08";
	context.fill();
}
//bee variables
var bee = {x:400, y:100, radius:6, dx:1, dy:1};
//var beeSting;
//var beeWings;
function drawBee() {
	//body
	context.beginPath();
	context.arc(bee.x, bee.y, bee.radius, degreesToRadians(360), false);
	context.fillStyle = '#FACC2E';
	context.fill();
	context.closePath();
	//stripe
	context.beginPath();
	context.moveTo(400,350);
	context.lineTo(400,305);
	context.lineWidth = 2
	context.strokeStyle = 'black';
	context.stroke();
	//wings
	//stinger
}



function degreesToRadians(degrees) {
	return(degrees * Math.PI)/180;
}


window.onload = function() {
	fillBG();
	startText();
	canvas.onclick = function(event) {
		clickSun(event.clientX, event.clientY);
	}

}


</script>
</head>
</html>
